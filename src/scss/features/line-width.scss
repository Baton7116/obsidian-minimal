/* Custom line width */

:root {
  --list-offset:0.5em;
}

/* With readable line width */
.markdown-preview-view.is-readable-line-width .markdown-preview-sizer {
  max-width:var(--max-width);
  width:var(--line-width-adaptive);
}
.markdown-source-view.is-readable-line-width .CodeMirror {
  padding-left:0;
  padding-right:0;
  margin:0 auto 0 auto;
  width:var(--line-width-adaptive);
  max-width:var(--max-width);
}

/* Readable line width off */
.markdown-preview-view .markdown-preview-sizer {
  max-width:var(--max-width);
  margin:0 auto;
  padding-left:var(--folding-offset);
}
.is-mobile .markdown-source-view.mod-cm6 .cm-gutters {
  padding-right:0;
}

/* Requires Minimal plugin 5.2.1+ */
.minimal-readable-off .view-header-title-container {
  width:var(--max-width);
}

/* Max width for readable-line length off */
.markdown-source-view.mod-cm6:not(.is-readable-line-width) .cm-contentContainer {
  max-width:var(--max-width);
  margin:0 0 0 calc(50% - var(--max-width)/2) !important;
  padding-left:var(--folding-offset);
}
.markdown-source-view.mod-cm6 .cm-content > [contenteditable=false] {
  contain:unset;
}


/* Live Preview */
.markdown-source-view.mod-cm6.is-line-wrap.is-readable-line-width .cm-content {
  max-width:100%;
}
.markdown-source-view.mod-cm6.is-line-wrap.is-readable-line-width .cm-line:not(.HyperMD-table-row) {
  max-width:calc(var(--max-width) - var(--folding-offset));
}

/* Nudge everything slightly to the left to make space for folding and gutters */
.markdown-source-view.mod-cm6.is-readable-line-width { 
  .internal-embed,
  .mod-empty,
  .cm-embed-block > mjx-container,
  .cm-embed-block > div,
  .cm-content > .image-embed,
  .cm-line,
  .cm-line.HyperMD-quote,
  .cm-line.HyperMD-codeblock,
  .embedded-backlinks,
  .cm-embed-block.cm-callout .callout,
  .cm-html-embed,
  .cm-content > img:not([width]),
  table {
    width:calc(var(--line-width-adaptive) - var(--folding-offset));
    max-width:calc(var(--max-width) - var(--folding-offset));
    margin:0 auto 0
      max(
      calc(50% + var(--folding-offset) - var(--line-width-adaptive)/2),
      calc(50% + var(--folding-offset) - var(--max-width)/2) ) !important;
  }
  .cm-content > img[width] {
    max-width:var(--max-width);
    margin-left:max(
      calc(50% + var(--folding-offset) - var(--line-width-adaptive)/2),
      calc(50% + var(--folding-offset) - var(--max-width)/2)) !important;
  }
}
/* Needs a couple more top-level rules to override default styling */
.markdown-source-view.mod-cm6.is-readable-line-width.is-line-wrap {
  .HyperMD-list-line {
    width:calc(var(--line-width-adaptive) - var(--folding-offset) - var(--list-offset));
    max-width:calc(var(--max-width) - var(--folding-offset) - var(--list-offset));
    margin:0 auto 0
      max(
      calc(50% + var(--list-offset) + var(--folding-offset) - var(--line-width-adaptive)/2),
      calc(50% + var(--list-offset) + var(--folding-offset) - var(--max-width)/2)) !important;
  }
}

/* Force Dataview Lists to use readable line width */
.is-live-preview.is-readable-line-width .list-view-ul,
.is-live-preview.is-readable-line-width .contains-task-list,
.markdown-preview-view.is-readable-line-width .block-language-dataview > h4,
.markdown-preview-view.is-readable-line-width .dataview.result-group,
.markdown-preview-view.is-readable-line-width .dataview.list-view-ul,
.markdown-preview-view.is-readable-line-width .dataview .contains-task-list,
.markdown-preview-view.is-readable-line-width .dataview.dataview-error {
  width:calc(var(--line-width-adaptive) - var(--folding-offset) - var(--list-offset));
  max-width:calc(var(--max-width) - var(--folding-offset) - var(--list-offset));
  transform:translateX(calc(var(--folding-offset)/2 - var(--list-offset)/2));
  margin:0 auto !important;
}
/* Fill the length of Dataview Lists when in normal length since parent container has the width we want */
body:not(.table-100):not(.table-max):not(.table-wide) .is-live-preview.is-readable-line-width:not(.table-100):not(.table-max):not(.table-wide) .list-view-ul,
body:not(.table-100):not(.table-max):not(.table-wide) .is-live-preview.is-readable-line-width:not(.table-100):not(.table-max):not(.table-wide) .contains-task-list {
  width:100%;
  max-width:100%;
  transform:none;
}
/* Same but in Reading mode */
body:not(.table-100):not(.table-max):not(.table-wide) .markdown-preview-view.is-readable-line-width:not(.table-100):not(.table-max):not(.table-wide) .list-view-ul,
body:not(.table-100):not(.table-max):not(.table-wide) .markdown-preview-view.is-readable-line-width:not(.table-100):not(.table-max):not(.table-wide) .contains-task-list {
  width:calc(var(--line-width-adaptive) - var(--list-offset));
  max-width:calc(var(--max-width) - var(--list-offset));
  margin:0 auto !important;
}

/* Make sure the table fills the width of the parent dataview block,
as opposed to regular tables */
.is-live-preview.is-readable-line-width.embed-strict .internal-embed .markdown-preview-sizer,
.is-readable-line-width .block-language-dataview table.dataview,
.is-live-preview.is-readable-line-width .cm-embed-block table.dataview {
  width:100%;
  max-width:100%;
  transform:none;
  margin-left:auto !important;
}

